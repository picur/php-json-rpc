<?php
require_once "Loader.php";

class TestService {
    public function run($test) {
        return "TEST ".$test;
    }
    public function calc($a,$b)
    {
        return $a*$b;
    }
    public function big(){
        $data = "................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................";
        return $data;
    }
}

$loader = new \JustAddicted\Loader\Loader();
$loader->registerNamespace("SectorNord", __DIR__."/SectorNord");
$loader->registerLoader();

$client = new TestService();
$a = microtime(true);

for ($i = 0; $i < 10000; $i++){
    $data = json_encode($client->big());

}

$b = microtime(true) - $a;

echo "Time used 10000-times: ".$b." (". $b/10000 ." each)\n";


$server = new \SectorNord\ZMQ\Rpc\Server();
$server->setZMQSocket("ipc:///tmp/2kservice");
$server->setService(new TestService());
$server->start();